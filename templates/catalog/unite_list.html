{% extends 'base.html' %}

{% block content %}
<div class="row mb-4 align-items-center">
  <div class="col-md-8">
    <h1 class="display-6 fw-bold">ğŸ˜ï¸ UnitÃ©s / Lots</h1>
    <p class="lead text-muted">GÃ©rer les unitÃ©s physiques liÃ©es aux programmes</p>
  </div>
  <div class="col-md-4 text-end">
    <a href="{% url 'unite_create' %}" class="btn btn-success">
      â• Ajouter une unitÃ©
    </a>
  </div>
</div>

{% if unites %}
  <div class="card shadow-sm border-0">
    <div class="table-responsive">
      <table class="table table-hover mb-0">
        <thead class="table-light">
          <tr>
            <th>RÃ©fÃ©rence</th>
            <th>Programme</th>
            <th>ModÃ¨le</th>
            <th>Prix TTC</th>
            <th>Statut</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          {% for unite in unites %}
            <tr>
              <td><strong>{{ unite.reference_lot }}</strong></td>
              <td>{{ unite.programme.nom }}</td>
              <td><span class="badge bg-secondary">{{ unite.modele_bien.nom_marketing }}</span></td>
              <td>{{ unite.prix_ttc|floatformat:0 }} FCFA</td>
              <td>
                {% with statut_reel=unite.get_statut_reel %}
                  {% if statut_reel == 'disponible' %}
                    <span class="badge bg-success">Disponible</span>
                  {% elif statut_reel == 'reserve' %}
                    <span class="badge bg-warning">RÃ©servÃ©</span>
                  {% elif statut_reel == 'vendu' %}
                    <span class="badge bg-danger">Vendu</span>
                  {% else %}
                    <span class="badge bg-info">LivrÃ©</span>
                  {% endif %}
                {% endwith %}
              </td>
              <td>
                <div class="d-flex gap-1">
                  <a href="{% url 'unite_detail' unite.pk %}" class="btn btn-sm btn-info">ğŸ‘ï¸</a>
                  <a href="{% url 'unite_edit' unite.pk %}" class="btn btn-sm btn-warning">âœï¸</a>
                  <form method="post" action="{% url 'unite_delete' unite.pk %}" style="display: inline;"
                        onsubmit="return confirm('Supprimer cette unitÃ© ?');">
                    {% csrf_token %}
                    <button type="submit" class="btn btn-sm btn-danger">ğŸ—‘ï¸</button>
                  </form>
                </div>
              </td>
            </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>
{% else %}
  <div class="alert alert-info">
    <p class="mb-0">Aucune unitÃ© enregistrÃ©e.</p>
  </div>
{% endif %}

<div class="mt-4">
  <a href="{% url 'admin_dashboard' %}" class="btn btn-secondary">â† Retour au dashboard</a>
</div>
{% endblock %}
